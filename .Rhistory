"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"))
ctx <- colnames(df_baseline)[grep("^schaefer100.*.wscore$", colnames(df_baseline))]
list <- append(ctx, paste0(sctx, "_wscore"))
atrophy_mapping_group1_cohend <- atrophy_mapping_group2_cohend <- atrophy_mapping_group1_pvalue <- atrophy_mapping_group2_pvalue <- data.frame(matrix(nrow = 1, ncol = length(list)))
colnames(atrophy_mapping_group1_cohend) <- colnames(atrophy_mapping_group2_cohend) <- gsub(pattern = "_wscore", replacement = "_cohend", list)
colnames(atrophy_mapping_group1_pvalue) <- colnames(atrophy_mapping_group2_pvalue) <- gsub(pattern = "_wscore", replacement = "_pvalue", list)
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="1", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group1_cohend[,i] <- -1 * cohend$estimate
atrophy_mapping_group1_pvalue[,i] <- ttest$p.value
}
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="2", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group2_cohend[,i] <- -1 * cohend$estimate
atrophy_mapping_group2_pvalue[,i] <- ttest$p.value
}
atrophy_mapping_group1_pvalue[1,] <- p.adjust(atrophy_mapping_group1_pvalue[1,], method = "fdr")
atrophy_mapping_group2_pvalue[1,] <- p.adjust(atrophy_mapping_group2_pvalue[1,], method = "fdr")
# write out
write.csv(atrophy_mapping_group1_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group1_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group1_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group1_pfdr.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group2_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group2_pfdr.csv"), row.names = FALSE)
View(atrophy_mapping_group1_cohend)
View(atrophy_mapping_group2_cohend)
View(atrophy_mapping_group2_pvalue)
View(atrophy_mapping_group1_pvalue)
df_baseline <- readRDS(here::here("data/df_baseline.Rds"))
## SchaeferSubcortex 114 parcels
hydra_labels <- read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/clustering_assignment.tsv"), sep = "\t")
hydra_ARI <- as.data.frame(t(read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/adjusted_rand_index.tsv"), sep = "\t", header = FALSE)))
colnames(hydra_ARI) <- c("N_subtypes", "ARI")
hydra_ARI$ARI <- as.numeric(hydra_ARI$ARI)
View(hydra_labels)
df_baseline <- readRDS(here::here("data/df_baseline.Rds"))
## SchaeferSubcortex 114 parcels
hydra_labels <- read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/clustering_assignment.tsv"), sep = "\t")
hydra_labels$assignment_2 <- factor(hydra_labels$assignment_2, levels = c("-1", "1", "2"))
hydra_ARI <- as.data.frame(t(read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/adjusted_rand_index.tsv"), sep = "\t", header = FALSE)))
colnames(hydra_ARI) <- c("N_subtypes", "ARI")
hydra_ARI$ARI <- as.numeric(hydra_ARI$ARI)
ggplot(data=hydra_ARI, aes(x=N_subtypes, y=ARI, group=1)) +
geom_line()+
geom_point()+
ylim(0,0.8)
df_baseline_hydra <- merge(df_baseline, hydra_labels, by.x = "id", by.y = "participant_id")
sctx <- c(paste("left", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"),
paste("right", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"))
ctx <- colnames(df_baseline)[grep("^schaefer100.*.wscore$", colnames(df_baseline))]
list <- append(ctx, paste0(sctx, "_wscore"))
atrophy_mapping_group1_cohend <- atrophy_mapping_group2_cohend <- atrophy_mapping_group1_pvalue <- atrophy_mapping_group2_pvalue <- data.frame(matrix(nrow = 1, ncol = length(list)))
colnames(atrophy_mapping_group1_cohend) <- colnames(atrophy_mapping_group2_cohend) <- gsub(pattern = "_wscore", replacement = "_cohend", list)
colnames(atrophy_mapping_group1_pvalue) <- colnames(atrophy_mapping_group2_pvalue) <- gsub(pattern = "_wscore", replacement = "_pvalue", list)
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="1", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group1_cohend[,i] <- -1 * cohend$estimate
atrophy_mapping_group1_pvalue[,i] <- ttest$p.value
}
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="2", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group2_cohend[,i] <- -1 * cohend$estimate
atrophy_mapping_group2_pvalue[,i] <- ttest$p.value
}
atrophy_mapping_group1_pvalue[1,] <- p.adjust(atrophy_mapping_group1_pvalue[1,], method = "fdr")
atrophy_mapping_group2_pvalue[1,] <- p.adjust(atrophy_mapping_group2_pvalue[1,], method = "fdr")
View(atrophy_mapping_group1_cohend)
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="1", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group1_cohend[,i] <- cohend$estimate
atrophy_mapping_group1_pvalue[,i] <- ttest$p.value
}
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="2", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group2_cohend[,i] <- cohend$estimate
atrophy_mapping_group2_pvalue[,i] <- ttest$p.value
}
atrophy_mapping_group1_pvalue[1,] <- p.adjust(atrophy_mapping_group1_pvalue[1,], method = "fdr")
atrophy_mapping_group2_pvalue[1,] <- p.adjust(atrophy_mapping_group2_pvalue[1,], method = "fdr")
View(atrophy_mapping_group1_pvalue)
View(atrophy_mapping_group2_pvalue)
View(atrophy_mapping_group1_cohend)
View(atrophy_mapping_group2_cohend)
i=1
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", list[i]]
d
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="2", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group2_cohend[,i] <- cohend$estimate
atrophy_mapping_group2_pvalue[,i] <- ttest$p.value
View(atrophy_mapping_group2_cohend)
cohend
d
f
ttest
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
cohend <- effsize::cohen.d(d, f)
cohend
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="1", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
ttest
f
class(f)
f <- factor(f, levels = c("1", "-1"))
class(f)
f
df_baseline <- readRDS(here::here("data/df_baseline.Rds"))
## SchaeferSubcortex 114 parcels
hydra_labels <- read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/clustering_assignment.tsv"), sep = "\t")
hydra_labels$assignment_2 <- factor(hydra_labels$assignment_2, levels = c("-1", "1", "2"))
hydra_ARI <- as.data.frame(t(read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/adjusted_rand_index.tsv"), sep = "\t", header = FALSE)))
colnames(hydra_ARI) <- c("N_subtypes", "ARI")
hydra_ARI$ARI <- as.numeric(hydra_ARI$ARI)
ggplot(data=hydra_ARI, aes(x=N_subtypes, y=ARI, group=1)) +
geom_line()+
geom_point()+
ylim(0,0.8)
df_baseline_hydra <- merge(df_baseline, hydra_labels, by.x = "id", by.y = "participant_id")
sctx <- c(paste("left", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"),
paste("right", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"))
ctx <- colnames(df_baseline)[grep("^schaefer100.*.wscore$", colnames(df_baseline))]
list <- append(ctx, paste0(sctx, "_wscore"))
atrophy_mapping_group1_cohend <- atrophy_mapping_group2_cohend <- atrophy_mapping_group1_pvalue <- atrophy_mapping_group2_pvalue <- data.frame(matrix(nrow = 1, ncol = length(list)))
colnames(atrophy_mapping_group1_cohend) <- colnames(atrophy_mapping_group2_cohend) <- gsub(pattern = "_wscore", replacement = "_cohend", list)
colnames(atrophy_mapping_group1_pvalue) <- colnames(atrophy_mapping_group2_pvalue) <- gsub(pattern = "_wscore", replacement = "_pvalue", list)
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("1", "-1"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="1", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group1_cohend[,i] <- cohend$estimate
atrophy_mapping_group1_pvalue[,i] <- ttest$p.value
}
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("2", "-1"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="2", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group2_cohend[,i] <- cohend$estimate
atrophy_mapping_group2_pvalue[,i] <- ttest$p.value
}
atrophy_mapping_group1_pvalue[1,] <- p.adjust(atrophy_mapping_group1_pvalue[1,], method = "fdr")
atrophy_mapping_group2_pvalue[1,] <- p.adjust(atrophy_mapping_group2_pvalue[1,], method = "fdr")
# write out
write.csv(atrophy_mapping_group1_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group1_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group1_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group1_pfdr.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group2_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group2_pfdr.csv"), row.names = FALSE)
View(atrophy_mapping_group2_cohend)
View(atrophy_mapping_group1_cohend)
df_baseline <- readRDS(here::here("data/df_baseline.Rds"))
## SchaeferSubcortex 114 parcels
hydra_labels <- read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/clustering_assignment.tsv"), sep = "\t")
hydra_labels$assignment_2 <- factor(hydra_labels$assignment_2, levels = c("-1", "1", "2"))
hydra_ARI <- as.data.frame(t(read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/adjusted_rand_index.tsv"), sep = "\t", header = FALSE)))
colnames(hydra_ARI) <- c("N_subtypes", "ARI")
hydra_ARI$ARI <- as.numeric(hydra_ARI$ARI)
ggplot(data=hydra_ARI, aes(x=N_subtypes, y=ARI, group=1)) +
geom_line()+
geom_point()+
ylim(0,0.8)
df_baseline_hydra <- merge(df_baseline, hydra_labels, by.x = "id", by.y = "participant_id")
sctx <- c(paste("left", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"),
paste("right", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"))
ctx <- colnames(df_baseline)[grep("^schaefer100.*.wscore$", colnames(df_baseline))]
list <- append(ctx, paste0(sctx, "_wscore"))
atrophy_mapping_group1_cohend <- atrophy_mapping_group2_cohend <- atrophy_mapping_group1_pvalue <- atrophy_mapping_group2_pvalue <- data.frame(matrix(nrow = 1, ncol = length(list)))
colnames(atrophy_mapping_group1_cohend) <- colnames(atrophy_mapping_group2_cohend) <- gsub(pattern = "_wscore", replacement = "_cohend", list)
colnames(atrophy_mapping_group1_pvalue) <- colnames(atrophy_mapping_group2_pvalue) <- gsub(pattern = "_wscore", replacement = "_pvalue", list)
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("-1", "1"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="1", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group1_cohend[,i] <- cohend$estimate
atrophy_mapping_group1_pvalue[,i] <- ttest$p.value
}
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("-1", "2"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="2", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group2_cohend[,i] <- cohend$estimate
atrophy_mapping_group2_pvalue[,i] <- ttest$p.value
}
atrophy_mapping_group1_pvalue[1,] <- p.adjust(atrophy_mapping_group1_pvalue[1,], method = "fdr")
atrophy_mapping_group2_pvalue[1,] <- p.adjust(atrophy_mapping_group2_pvalue[1,], method = "fdr")
# write out
write.csv(atrophy_mapping_group1_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group1_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group1_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group1_pfdr.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group2_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group2_pfdr.csv"), row.names = FALSE)
summary(df_baseline_hydra$disease_duration[df_baseline_hydra$assignment_2=="1"])
summary(df_baseline_hydra$disease_duration[df_baseline_hydra$assignment_2=="2"])
summary(df_baseline_hydra$clinical_phenotype[df_baseline_hydra$assignment_2=="2"])
summary(df_baseline_hydra$clinical_phenotype[df_baseline_hydra$assignment_2=="1"])
df_baseline <- readRDS(here::here("data/df_baseline.Rds"))
## SchaeferSubcortex 114 parcels
hydra_labels <- read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/clustering_assignment.tsv"), sep = "\t")
hydra_labels$assignment_2 <- factor(hydra_labels$assignment_2, levels = c("-1", "1", "2"))
hydra_ARI <- as.data.frame(t(read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/adjusted_rand_index.tsv"), sep = "\t", header = FALSE)))
colnames(hydra_ARI) <- c("N_subtypes", "ARI")
hydra_ARI$ARI <- as.numeric(hydra_ARI$ARI)
ggplot(data=hydra_ARI, aes(x=N_subtypes, y=ARI, group=1)) +
geom_line()+
geom_point()+
ylim(0,0.8)
df_baseline_hydra <- merge(df_baseline, hydra_labels, by.x = "id", by.y = "participant_id")
sctx <- c(paste("left", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"),
paste("right", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"))
ctx <- colnames(df_baseline)[grep("^schaefer100.*.wscore$", colnames(df_baseline))]
list <- append(ctx, paste0(sctx, "_wscore"))
atrophy_mapping_group1_cohend <- atrophy_mapping_group2_cohend <- atrophy_mapping_group1_pvalue <- atrophy_mapping_group2_pvalue <- data.frame(matrix(nrow = 1, ncol = length(list)))
colnames(atrophy_mapping_group1_cohend) <- colnames(atrophy_mapping_group2_cohend) <- gsub(pattern = "_wscore", replacement = "_cohend", list)
colnames(atrophy_mapping_group1_pvalue) <- colnames(atrophy_mapping_group2_pvalue) <- gsub(pattern = "_wscore", replacement = "_pvalue", list)
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("-1", "1"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="1", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group1_cohend[,i] <- cohend$estimate
atrophy_mapping_group1_pvalue[,i] <- ttest$p.value
}
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("-1", "2"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="2", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group2_cohend[,i] <- cohend$estimate
atrophy_mapping_group2_pvalue[,i] <- ttest$p.value
}
atrophy_mapping_group1_pvalue[1,] <- p.adjust(atrophy_mapping_group1_pvalue[1,], method = "fdr")
atrophy_mapping_group2_pvalue[1,] <- p.adjust(atrophy_mapping_group2_pvalue[1,], method = "fdr")
# write out
write.csv(atrophy_mapping_group1_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group1_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group1_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group1_pfdr.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group2_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group2_pfdr.csv"), row.names = FALSE)
## SchaeferSubcortex 414 parcels
hydra_labels <- read.csv(here::here("output/hydra_SchaeferSubcortex414Parcels/clustering/clustering_assignment.tsv"), sep = "\t")
hydra_labels$assignment_2 <- factor(hydra_labels$assignment_2, levels = c("-1", "1", "2"))
hydra_ARI <- as.data.frame(t(read.csv(here::here("output/hydra_SchaeferSubcortex414Parcels/clustering/adjusted_rand_index.tsv"), sep = "\t", header = FALSE)))
colnames(hydra_ARI) <- c("N_subtypes", "ARI")
hydra_ARI$ARI <- as.numeric(hydra_ARI$ARI)
ggplot(data=hydra_ARI, aes(x=N_subtypes, y=ARI, group=1)) +
geom_line()+
geom_point()+
ylim(0,0.8)
df_baseline_hydra <- merge(df_baseline, hydra_labels, by.x = "id", by.y = "participant_id")
sctx <- c(paste("left", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"),
paste("right", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"))
ctx <- colnames(df_baseline)[grep("^schaefer400.*.wscore$", colnames(df_baseline))]
list <- append(ctx, paste0(sctx, "_wscore"))
atrophy_mapping_group1_cohend <- atrophy_mapping_group2_cohend <- atrophy_mapping_group1_pvalue <- atrophy_mapping_group2_pvalue <- data.frame(matrix(nrow = 1, ncol = length(list)))
colnames(atrophy_mapping_group1_cohend) <- colnames(atrophy_mapping_group2_cohend) <- gsub(pattern = "_wscore", replacement = "_cohend", list)
colnames(atrophy_mapping_group1_pvalue) <- colnames(atrophy_mapping_group2_pvalue) <- gsub(pattern = "_wscore", replacement = "_pvalue", list)
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("-1", "1"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="1", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group1_cohend[,i] <- cohend$estimate
atrophy_mapping_group1_pvalue[,i] <- ttest$p.value
}
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("-1", "2"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="2", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group2_cohend[,i] <- cohend$estimate
atrophy_mapping_group2_pvalue[,i] <- ttest$p.value
}
atrophy_mapping_group1_pvalue[1,] <- p.adjust(atrophy_mapping_group1_pvalue[1,], method = "fdr")
atrophy_mapping_group2_pvalue[1,] <- p.adjust(atrophy_mapping_group2_pvalue[1,], method = "fdr")
# write out
write.csv(atrophy_mapping_group1_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex414Parcels_group1_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group1_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex414Parcels_group1_pfdr.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex414Parcels_group2_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex414Parcels_group2_pfdr.csv"), row.names = FALSE)
View(atrophy_mapping_group1_cohend)
View(atrophy_mapping_group2_cohend)
summary(df_baseline_hydra$clinical_phenotype[df_baseline_hydra$assignment_2=="1"])
summary(df_baseline_hydra$clinical_phenotype[df_baseline_hydra$assignment_2=="2"])
summary(df_baseline_hydra$brain_seg_vol_to_e_tiv[df_baseline_hydra$assignment_2=="2"])
summary(df_baseline_hydra$brain_seg_vol_to_e_tiv[df_baseline_hydra$assignment_2=="1"])
View(hydra_labels)
df_baseline <- readRDS(here::here("data/df_baseline.Rds"))
## SchaeferSubcortex 114 parcels
hydra_labels <- read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/clustering_assignment.tsv"), sep = "\t")
hydra_labels$assignment_2 <- factor(hydra_labels$assignment_2, levels = c("-1", "1", "2"))
hydra_ARI <- as.data.frame(t(read.csv(here::here("output/hydra_SchaeferSubcortex114Parcels/clustering/adjusted_rand_index.tsv"), sep = "\t", header = FALSE)))
colnames(hydra_ARI) <- c("N_subtypes", "ARI")
hydra_ARI$ARI <- as.numeric(hydra_ARI$ARI)
ggplot(data=hydra_ARI, aes(x=N_subtypes, y=ARI, group=1)) +
geom_line()+
geom_point()+
ylim(0,0.8)
# write optimal clustering
hydra_labels_2subtypes <- hydra_labels[, c("participant_id", "session_id", "diagnosis", "assignment_2")]
write.csv(hydra_labels_2subtypes, here::here("data/hydra_SchaeferSubcortex114Parcels_2subtypes.csv"), row.names = FALSE)
# explore atrophy patterns
df_baseline_hydra <- merge(df_baseline, hydra_labels, by.x = "id", by.y = "participant_id")
sctx <- c(paste("left", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"),
paste("right", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"))
ctx <- colnames(df_baseline)[grep("^schaefer100.*.wscore$", colnames(df_baseline))]
list <- append(ctx, paste0(sctx, "_wscore"))
atrophy_mapping_group1_cohend <- atrophy_mapping_group2_cohend <- atrophy_mapping_group1_pvalue <- atrophy_mapping_group2_pvalue <- data.frame(matrix(nrow = 1, ncol = length(list)))
colnames(atrophy_mapping_group1_cohend) <- colnames(atrophy_mapping_group2_cohend) <- gsub(pattern = "_wscore", replacement = "_cohend", list)
colnames(atrophy_mapping_group1_pvalue) <- colnames(atrophy_mapping_group2_pvalue) <- gsub(pattern = "_wscore", replacement = "_pvalue", list)
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("-1", "1"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="1", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group1_cohend[,i] <- cohend$estimate
atrophy_mapping_group1_pvalue[,i] <- ttest$p.value
}
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("-1", "2"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="2", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group2_cohend[,i] <- cohend$estimate
atrophy_mapping_group2_pvalue[,i] <- ttest$p.value
}
atrophy_mapping_group1_pvalue[1,] <- p.adjust(atrophy_mapping_group1_pvalue[1,], method = "fdr")
atrophy_mapping_group2_pvalue[1,] <- p.adjust(atrophy_mapping_group2_pvalue[1,], method = "fdr")
# write out
write.csv(atrophy_mapping_group1_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group1_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group1_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group1_pfdr.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group2_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex114Parcels_group2_pfdr.csv"), row.names = FALSE)
## SchaeferSubcortex 414 parcels
hydra_labels <- read.csv(here::here("output/hydra_SchaeferSubcortex414Parcels/clustering/clustering_assignment.tsv"), sep = "\t")
hydra_labels$assignment_2 <- factor(hydra_labels$assignment_2, levels = c("-1", "1", "2"))
hydra_ARI <- as.data.frame(t(read.csv(here::here("output/hydra_SchaeferSubcortex414Parcels/clustering/adjusted_rand_index.tsv"), sep = "\t", header = FALSE)))
colnames(hydra_ARI) <- c("N_subtypes", "ARI")
hydra_ARI$ARI <- as.numeric(hydra_ARI$ARI)
ggplot(data=hydra_ARI, aes(x=N_subtypes, y=ARI, group=1)) +
geom_line()+
geom_point()+
ylim(0,0.8)
# write optimal clustering
hydra_labels_2subtypes <- hydra_labels[, c("participant_id", "session_id", "diagnosis", "assignment_2")]
write.csv(hydra_labels_2subtypes, here::here("data/hydra_SchaeferSubcortex414Parcels_2subtypes.csv"), row.names = FALSE)
# explore atrophy patterns
df_baseline_hydra <- merge(df_baseline, hydra_labels, by.x = "id", by.y = "participant_id")
sctx <- c(paste("left", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"),
paste("right", c("accumbens_area",
"amygdala",
"caudate",
"hippocampus",
"pallidum",
"putamen",
"thalamus"),
sep = "_"))
ctx <- colnames(df_baseline)[grep("^schaefer400.*.wscore$", colnames(df_baseline))]
list <- append(ctx, paste0(sctx, "_wscore"))
atrophy_mapping_group1_cohend <- atrophy_mapping_group2_cohend <- atrophy_mapping_group1_pvalue <- atrophy_mapping_group2_pvalue <- data.frame(matrix(nrow = 1, ncol = length(list)))
colnames(atrophy_mapping_group1_cohend) <- colnames(atrophy_mapping_group2_cohend) <- gsub(pattern = "_wscore", replacement = "_cohend", list)
colnames(atrophy_mapping_group1_pvalue) <- colnames(atrophy_mapping_group2_pvalue) <- gsub(pattern = "_wscore", replacement = "_pvalue", list)
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="1" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("-1", "1"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="1", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group1_cohend[,i] <- cohend$estimate
atrophy_mapping_group1_pvalue[,i] <- ttest$p.value
}
for (i in 1:length(list)) {
d <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", list[i]]
f <- df_baseline_hydra[df_baseline_hydra$assignment_2=="2" | df_baseline_hydra$assignment_2=="-1", "assignment_2"]
f <- factor(f, levels = c("-1", "2"))
cohend <- effsize::cohen.d(d, f)
ttest <- t.test(df_baseline_hydra[df_baseline_hydra$assignment_2=="2", list[i]], df_baseline_hydra[df_baseline_hydra$assignment_2=="-1", list[i]])
atrophy_mapping_group2_cohend[,i] <- cohend$estimate
atrophy_mapping_group2_pvalue[,i] <- ttest$p.value
}
atrophy_mapping_group1_pvalue[1,] <- p.adjust(atrophy_mapping_group1_pvalue[1,], method = "fdr")
atrophy_mapping_group2_pvalue[1,] <- p.adjust(atrophy_mapping_group2_pvalue[1,], method = "fdr")
# write out
write.csv(atrophy_mapping_group1_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex414Parcels_group1_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group1_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex414Parcels_group1_pfdr.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_cohend, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex414Parcels_group2_cohend.csv"), row.names = FALSE)
write.csv(atrophy_mapping_group2_pvalue, here::here("data/atrophy_cross/atrophy_baseline_SchaeferSubcortex414Parcels_group2_pfdr.csv"), row.names = FALSE)
?case_when
library(mgcv)
